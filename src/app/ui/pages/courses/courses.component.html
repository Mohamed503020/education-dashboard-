<div class="courses">
  <!-- Hero Header -->
  <div class="courses__hero">
    <div class="courses__hero-content">
      <h1 class="courses__title">{{ 'courses.title' | translate }}</h1>
      <p class="courses__subtitle">{{ totalCourses }} courses available</p>
    </div>
    <div class="courses__hero-actions">
      @if (isTeacher) {
        <button class="btn btn--primary btn--glow" routerLink="/courses/add">
          <span class="material-icons">add</span>
          {{ 'courses.addNew' | translate }}
        </button>
      }
    </div>
  </div>

  <!-- Category Stats -->
  <div class="courses__categories">
    @for (cat of categoryStats; track cat.name) {
      <div class="category-card" [style.--cat-color]="cat.color">
        <div class="category-card__icon">
          <span class="material-icons">{{ cat.icon }}</span>
        </div>
        <div class="category-card__info">
          <span class="category-card__count">{{ cat.count }}</span>
          <span class="category-card__name">{{ cat.name }}</span>
        </div>
      </div>
    }
  </div>

  <!-- Filters Section -->
  <div class="courses__filter-bar">
    <div class="courses__search">
      <span class="material-icons">search</span>
      <input 
        type="text" 
        [placeholder]="'common.search' | translate"
        [ngModel]="searchQuery()"
        (ngModelChange)="searchQuery.set($event)"
        (keyup.enter)="onSearch()"
      >
    </div>
    <div class="courses__filters">
      <select 
        class="filter-select"
        [ngModel]="selectedCategory()"
        (ngModelChange)="selectedCategory.set($event); loadCourses()"
      >
        <option value="">All Categories</option>
        @for (cat of categories; track cat) {
          <option [value]="cat">{{ cat }}</option>
        }
      </select>
      <select 
        class="filter-select"
        [ngModel]="selectedLevel()"
        (ngModelChange)="selectedLevel.set($event); loadCourses()"
      >
        <option value="">All Levels</option>
        @for (level of levels; track level) {
          <option [value]="level">{{ level | titlecase }}</option>
        }
      </select>
    </div>
    <div class="courses__view-toggle">
      <button 
        class="view-btn" 
        [class.view-btn--active]="viewMode() === 'grid'"
        (click)="setViewMode('grid')"
      >
        <span class="material-icons">grid_view</span>
      </button>
      <button 
        class="view-btn" 
        [class.view-btn--active]="viewMode() === 'list'"
        (click)="setViewMode('list')"
      >
        <span class="material-icons">view_list</span>
      </button>
    </div>
  </div>

  <!-- Loading State -->
  @if (isLoading) {
    <div class="courses__loading">
      <div class="spinner"></div>
      <p>Loading courses...</p>
    </div>
  }

  <!-- Courses Grid/List -->
  @if (!isLoading) {
    <div class="courses__content" [class.courses__content--list]="viewMode() === 'list'">
      @for (course of filteredCourses; track course._id) {
        <div class="course-card" [class.course-card--list]="viewMode() === 'list'" [style.--course-color]="getCourseColor(course)">
          <!-- Card Image/Header -->
          <div class="course-card__visual">
            <div class="course-card__gradient"></div>
            <div class="course-card__icon">
              <span class="material-icons">menu_book</span>
            </div>
            <span class="course-card__code">{{ course.category || 'General' }}</span>
            <span class="status-badge" [class]="getStatusClass(course.status)">
              {{ course.status === 'published' ? 'Active' : course.status === 'draft' ? 'Draft' : 'Archived' }}
            </span>
          </div>

          <!-- Card Body -->
          <div class="course-card__body">
            <div class="course-card__header">
              <span class="level-badge" [class]="getLevelBadgeClass(course.level)">
                {{ course.level | titlecase }}
              </span>
              @if (course.price && course.price > 0) {
                <div class="course-card__rating">
                  <span class="material-icons">attach_money</span>
                  <span>{{ course.price }}</span>
                </div>
              } @else {
                <div class="course-card__rating">
                  <span style="color: #10b981; font-weight: 600;">Free</span>
                </div>
              }
            </div>

            <h3 class="course-card__title" [routerLink]="['/courses', course._id]">
              {{ course.title }}
            </h3>

            <p class="course-card__department">
              <span class="material-icons">category</span>
              {{ course.category || 'Uncategorized' }}
            </p>

            <div class="course-card__meta">
              <div class="meta-item">
                <span class="material-icons">people</span>
                <span>{{ getEnrollmentCount(course) }} Students</span>
              </div>
              <div class="meta-item">
                <span class="material-icons">event</span>
                <span>{{ course.createdAt | date:'mediumDate' }}</span>
              </div>
            </div>

            <div class="course-card__instructor">
              <div class="instructor-avatar">
                <span class="material-icons">person</span>
              </div>
              <span class="instructor-name">{{ getTeacherName(course) }}</span>
            </div>
          </div>

          <!-- Card Footer -->
          <div class="course-card__footer">
            <div class="course-card__credits">
              @if (course.tags && course.tags.length > 0) {
                <span class="material-icons">label</span>
                {{ course.tags[0] }}
              }
            </div>
            <div class="course-card__actions">
              <button class="action-btn action-btn--view" [routerLink]="['/courses', course._id]" title="View Details">
                <span class="material-icons">visibility</span>
              </button>
              @if (isTeacher) {
                <button class="action-btn action-btn--edit" [routerLink]="['/courses/edit', course._id]" title="Edit Course">
                  <span class="material-icons">edit</span>
                </button>
                <button class="action-btn action-btn--delete" title="Delete Course" (click)="deleteCourse(course._id)">
                  <span class="material-icons">delete</span>
                </button>
              }
            </div>
          </div>
        </div>
      }
    </div>
  }

  <!-- Empty State -->
  @if (!isLoading && filteredCourses.length === 0) {
    <div class="courses__empty">
      <span class="material-icons">search_off</span>
      <h3>No courses found</h3>
      <p>Try adjusting your filters or search query</p>
    </div>
  }
</div>
