@if (loading) {
  <div class="loading-state" dir="rtl">
    <div class="spinner"></div>
    <p>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
  </div>
} @else {
  <div class="my-courses-page" dir="rtl">
    <div class="container">
      <div class="page-header">
        <h1>ğŸ“š ÙƒÙˆØ±Ø³Ø§ØªÙŠ</h1>
        <p>ØªØ§Ø¨Ø¹ ØªÙ‚Ø¯Ù…Ùƒ ÙÙŠ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª Ø§Ù„Ù…Ø³Ø¬Ù„ Ø¨Ù‡Ø§</p>
      </div>

      <!-- Tabs -->
      <div class="tabs">
        <button class="tab" [class.active]="activeTab === 'courses'" (click)="activeTab = 'courses'">
          ğŸ“– ÙƒÙˆØ±Ø³Ø§ØªÙŠ ({{ enrollments.length }})
        </button>
        <button class="tab" [class.active]="activeTab === 'certificates'" (click)="activeTab = 'certificates'">
          ğŸ† Ø´Ù‡Ø§Ø¯Ø§ØªÙŠ ({{ certificates.length }})
        </button>
      </div>

      <!-- Courses Tab -->
      @if (activeTab === 'courses') {
        @if (enrollments.length === 0) {
          <div class="empty-state">
            <div class="empty-icon">ğŸ“­</div>
            <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙˆØ±Ø³Ø§Øª Ù…Ø³Ø¬Ù„Ø©</h3>
            <p>Ø§Ø¨Ø¯Ø£ Ø¨ØªØµÙØ­ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© ÙˆØ³Ø¬Ù„ ÙÙŠ Ù…Ø§ ÙŠÙ†Ø§Ø³Ø¨Ùƒ</p>
            <a routerLink="/site" class="btn btn-primary">ØªØµÙØ­ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª</a>
          </div>
        } @else {
          <div class="courses-grid">
            @for (enrollment of enrollments; track enrollment._id) {
              <div class="course-card">
                <div class="card-header" [style.border-right-color]="getStageColor(enrollment.course?.stage)">
                  @if (enrollment.course?.stage) {
                    <span class="stage-badge" [style.background]="getStageColor(enrollment.course?.stage)">
                      {{ getStageName(enrollment.course?.stage) }}
                    </span>
                  }
                  <h3 class="course-title">
                    <a [routerLink]="['/site/course', getCourseId(enrollment)]">{{ getCourseName(enrollment) }}</a>
                  </h3>
                </div>

                <div class="card-body">
                  @if (enrollment.course?.description) {
                    <p class="course-desc">{{ enrollment.course.description | slice:0:100 }}...</p>
                  }

                  <div class="card-meta">
                    <span>ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„: {{ getFormattedDate(enrollment.enrolledAt || enrollment.createdAt) }}</span>
                  </div>
                </div>

                <div class="card-footer">
                  <a [routerLink]="['/site/course', getCourseId(enrollment)]" class="btn btn-outline">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙˆØ±Ø³</a>
                  @if (getCertificateForCourse(getCourseId(enrollment)); as cert) {
                    <a [routerLink]="['/site/certificate', cert._id]" class="btn btn-accent">ğŸ† Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©</a>
                  }
                </div>
              </div>
            }
          </div>
        }
      }

      <!-- Certificates Tab -->
      @if (activeTab === 'certificates') {
        @if (certificates.length === 0) {
          <div class="empty-state">
            <div class="empty-icon">ğŸ†</div>
            <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø´Ù‡Ø§Ø¯Ø§Øª Ø¨Ø¹Ø¯</h3>
            <p>Ø£ÙƒÙ…Ù„ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª ÙˆØ§Ø¬ØªØ² Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø´Ù‡Ø§Ø¯Ø§Øª</p>
          </div>
        } @else {
          <div class="certs-grid">
            @for (cert of certificates; track cert._id) {
              <div class="cert-card">
                <div class="cert-icon">ğŸ†</div>
                <h3>{{ cert.courseName }}</h3>
                <div class="cert-score">Ø§Ù„Ø¯Ø±Ø¬Ø©: <strong>{{ cert.examScore }}%</strong></div>
                <div class="cert-date">{{ getFormattedDate(cert.issueDate) }}</div>
                <div class="cert-number">{{ cert.certificateNumber }}</div>
                <a [routerLink]="['/site/certificate', cert._id]" class="btn btn-primary btn-sm">Ø¹Ø±Ø¶ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©</a>
              </div>
            }
          </div>
        }
      }
    </div>
  </div>
}
