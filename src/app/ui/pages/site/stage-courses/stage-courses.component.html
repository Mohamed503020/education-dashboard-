<div class="stage-page" dir="rtl">
  <!-- Stage Header -->
  <section class="stage-header" [style.--color]="currentStageInfo.color">
    <div class="container">
      <div class="stage-header-content">
        <span class="stage-icon">{{ currentStageInfo.icon }}</span>
        <h1>{{ currentStageInfo.name }}</h1>
        <p>{{ currentStageInfo.description }}</p>
        <div class="stage-tabs">
          <a routerLink="/site/courses/primary" class="tab" [class.active]="stage === 'primary'">Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</a>
          <a routerLink="/site/courses/preparatory" class="tab" [class.active]="stage === 'preparatory'">Ø§Ø¹Ø¯Ø§Ø¯ÙŠ</a>
          <a routerLink="/site/courses/secondary" class="tab" [class.active]="stage === 'secondary'">Ø«Ø§Ù†ÙˆÙŠ</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Search & Content -->
  <section class="courses-content">
    <div class="container">
      <div class="search-bar">
        <input
          type="text"
          [(ngModel)]="searchQuery"
          (input)="onSearch()"
          placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† ÙƒÙˆØ±Ø³..."
          class="search-input"
        >
        <span class="search-icon">ğŸ”</span>
      </div>

      <div class="results-info">
        <span>{{ filteredCourses.length }} ÙƒÙˆØ±Ø³ Ù…ØªØ§Ø­</span>
      </div>

      @if (loading) {
        <div class="loading">
          <div class="spinner"></div>
          <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª...</p>
        </div>
      } @else if (filteredCourses.length === 0) {
        <div class="empty">
          <span class="empty-icon">ğŸ“š</span>
          <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙˆØ±Ø³Ø§Øª Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</h3>
          <p>Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© ÙƒÙˆØ±Ø³Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø±Ø­Ù„Ø©</p>
        </div>
      } @else {
        <div class="courses-grid">
          @for (course of filteredCourses; track course._id) {
            <a [routerLink]="['/site/course', course._id]" class="course-card">
              <div class="course-thumb">
                @if (course.thumbnail) {
                  <img [src]="course.thumbnail" [alt]="course.title">
                } @else {
                  <div class="thumb-placeholder">ğŸ“š</div>
                }
                @if (course.grade) {
                  <span class="grade-badge">{{ getGradeName(course.grade) }}</span>
                }
              </div>
              <div class="course-body">
                <h3>{{ course.title }}</h3>
                <p class="course-desc">{{ course.shortDescription || course.description | slice:0:80 }}...</p>
                <div class="course-teacher">
                  <span class="teacher-icon">ğŸ‘¨â€ğŸ«</span>
                  <span>{{ getTeacherName(course) }}</span>
                </div>
                <div class="course-meta">
                  <span>ğŸ“– {{ course.materials.length || 0 }} Ø¯Ø±Ø³</span>
                  <span>ğŸ‘¥ {{ course.enrollmentCount || 0 }} Ø·Ø§Ù„Ø¨</span>
                </div>
                <div class="course-footer">
                  @if (course.isFree || course.price === 0) {
                    <span class="price free">Ù…Ø¬Ø§Ù†ÙŠ</span>
                  } @else {
                    <span class="price">{{ course.price }} Ø¬Ù†ÙŠÙ‡</span>
                  }
                  <span class="enroll-btn">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</span>
                </div>
              </div>
            </a>
          }
        </div>
      }
    </div>
  </section>
</div>
